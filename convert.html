<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Copy Image</title>
</head>

<body>
    <!-- Navigation Bar -->
    <nav style="background-color: #444; color: white; padding: 15px;">
        <div style="text-align: center; font-size: 1.8em; font-weight: bold;">Copy Image to Clipboard</div>
        <ul style="list-style: none; display: flex; justify-content: center; margin: 10px 0 0; padding: 0;">
            <li style="margin: 0 10px;">
                <a href="./index.html"
                    style="color: white; text-decoration: none; background-color: #555; padding: 10px 20px; border-radius: 5px; display: inline-block;">see
                    sample that works only on PNG images</a>
            </li>
            <li style="margin: 0 10px;">
                <a href="./convert.html"
                    style="color: white; text-decoration: none; background-color: #555; padding: 10px 20px; border-radius: 5px; display: inline-block;">see
                    sample that works for All Images</a>
            </li>
        </ul>
    </nav>

    <!-- Heading for the page -->
    <h3>Copy Image to Clipboard (works for all images with PNG conversion)</h3>

    <!-- Image to be copied -->
    <img id="img1" src="./images/photo.jpeg" width="200" alt="Product Image">
    <br>
    <!-- Button to trigger the copy action -->
    <button id="copyBtn1">üìã Copy Image 1</button>

    <br>
    <br>

    <!-- Second Image to be copied -->
    <img id="img2" src="./images/photo.avif" width="200" alt="Second Product Image">
    <br>
    <!-- Button to trigger the copy action for the second image -->
    <button id="copyBtn2">üìã Copy Image 2</button>

    <script>
        // Add a click event listener to the first button
        document.getElementById('copyBtn1').addEventListener('click', async () => {
            try {
                // Fetch the image from the provided URL
                const blob = await (await fetch('./images/photo.jpeg')).blob();

                // Convert the fetched image into a bitmap for further processing
                const bitmap = await createImageBitmap(blob);

                // Create a canvas element to draw the image
                const canvas = document.createElement('canvas');
                canvas.width = bitmap.width; // Set canvas width to image width
                canvas.height = bitmap.height; // Set canvas height to image height

                // Draw the image onto the canvas
                canvas.getContext('2d').drawImage(bitmap, 0, 0);

                // Convert the canvas content to a PNG blob
                const pngBlob = await new Promise(r => canvas.toBlob(r, 'image/png'));

                // Copy the PNG blob to the clipboard using the Clipboard API
                await navigator.clipboard.write([new ClipboardItem({ 'image/png': pngBlob })]);

                // Notify the user that the image has been copied successfully
                alert('‚úÖ Image 1 copied to clipboard as PNG!');
            } catch (error) {
                // Handle errors (e.g., unsupported browser, HTTPS requirement)
                console.error(error);
                alert('‚ùå Failed to copy Image 1. Make sure you are using Chrome/Edge over HTTPS or localhost.');
            }
        });

        // Add a click event listener to the second button
        document.getElementById('copyBtn2').addEventListener('click', async () => {
            try {
                // Fetch the second image from the provided URL
                const blob = await (await fetch('./images/photo.avif')).blob();

                // Convert the fetched image into a bitmap for further processing
                const bitmap = await createImageBitmap(blob);

                // Create a canvas element to draw the image
                const canvas = document.createElement('canvas');
                canvas.width = bitmap.width; // Set canvas width to image width
                canvas.height = bitmap.height; // Set canvas height to image height

                // Draw the image onto the canvas
                canvas.getContext('2d').drawImage(bitmap, 0, 0);

                // Convert the canvas content to a PNG blob
                const pngBlob = await new Promise(r => canvas.toBlob(r, 'image/png'));

                // Copy the PNG blob to the clipboard using the Clipboard API
                await navigator.clipboard.write([new ClipboardItem({ 'image/png': pngBlob })]);

                // Notify the user that the second image has been copied successfully
                alert('‚úÖ Image 2 copied to clipboard as PNG!');
            } catch (error) {
                // Handle errors (e.g., unsupported browser, HTTPS requirement)
                console.error(error);
                alert('‚ùå Failed to copy Image 2. Make sure you are using Chrome/Edge over HTTPS or localhost.');
            }
        });
    </script>
</body>

</html>
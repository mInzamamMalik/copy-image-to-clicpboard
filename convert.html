<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Copy Image</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- Navigation Bar -->
    <nav>
        <div>Copy Image to Clipboard</div>
        <ul>
            <li><a href="./index.html">see sample that works only on PNG images</a></li>
            <li><a href="./convert.html">see sample that works for All Images</a></li>
        </ul>
    </nav>

    <!-- Heading for the page -->
    <h3>Copy Image to Clipboard (works for all images with PNG conversion)</h3>

    <!-- First Image Card -->
    <div class="card">
        <h4>JPEG</h4>
        <img id="img1" src="./images/photo.jpeg" alt="Product Image">
        <br>
        <!-- Button to trigger the copy action -->
        <button id="copyBtn1">üìã Copy Image</button>
    </div>

    <!-- Second Image Card -->
    <div class="card">
        <h4>AVIF</h4>
        <img id="img2" src="./images/photo.avif" alt="Second Product Image">
        <br>
        <!-- Button to trigger the copy action for the second image -->
        <button id="copyBtn2">üìã Copy Image</button>
    </div>

    <!-- Third Image Card -->
    <div class="card">
        <h4>WEBP</h4>
        <img id="img3" src="./images/photo.webp" alt="Third Product Image">
        <br>
        <button id="copyBtn3">üìã Copy Image</button>
    </div>

    <!-- Fourth Image Card -->
    <div class="card">
        <h4>JPG</h4>
        <img id="img4" src="./images/photo.jpg" alt="Fourth Product Image">
        <br>
        <button id="copyBtn4">üìã Copy Image</button>
    </div>

    <script>
        // Event listener for the first image copy button
        document.getElementById('copyBtn1').addEventListener('click', async () => {
            try {
                // Fetch the JPEG image from the server
                const blob = await (await fetch('./images/photo.jpeg')).blob();

                // Convert the image blob into a bitmap for rendering
                const bitmap = await createImageBitmap(blob);

                // Create a canvas to draw the image
                const canvas = document.createElement('canvas');
                canvas.width = bitmap.width;
                canvas.height = bitmap.height;
                canvas.getContext('2d').drawImage(bitmap, 0, 0);

                // Convert the canvas content to a PNG blob
                const pngBlob = await new Promise(r => canvas.toBlob(r, 'image/png'));

                // Copy the PNG blob to the clipboard
                await navigator.clipboard.write([new ClipboardItem({ 'image/png': pngBlob })]);

                // Notify the user of success
                alert('‚úÖ Image 1 copied to clipboard as PNG!');
            } catch (error) {
                // Handle errors (e.g., unsupported browser, HTTPS requirement)
                console.error(error);
                alert('‚ùå Failed to copy Image 1. Ensure you are using Chrome/Edge over HTTPS or localhost.');
            }
        });

        // Event listener for the second image copy button
        document.getElementById('copyBtn2').addEventListener('click', async () => {
            try {
                // Fetch the AVIF image from the server
                const blob = await (await fetch('./images/photo.avif')).blob();

                // Convert the image blob into a bitmap for rendering
                const bitmap = await createImageBitmap(blob);

                // Create a canvas to draw the image
                const canvas = document.createElement('canvas');
                canvas.width = bitmap.width;
                canvas.height = bitmap.height;
                canvas.getContext('2d').drawImage(bitmap, 0, 0);

                // Convert the canvas content to a PNG blob
                const pngBlob = await new Promise(r => canvas.toBlob(r, 'image/png'));

                // Copy the PNG blob to the clipboard
                await navigator.clipboard.write([new ClipboardItem({ 'image/png': pngBlob })]);

                // Notify the user of success
                alert('‚úÖ Image 2 copied to clipboard as PNG!');
            } catch (error) {
                // Handle errors (e.g., unsupported browser, HTTPS requirement)
                console.error(error);
                alert('‚ùå Failed to copy Image 2. Ensure you are using Chrome/Edge over HTTPS or localhost.');
            }
        });

        // Event listener for the third image copy button
        document.getElementById('copyBtn3').addEventListener('click', async () => {
            try {
                // Fetch the WEBP image from the server
                const blob = await (await fetch('./images/photo.webp')).blob();

                // Convert the image blob into a bitmap for rendering
                const bitmap = await createImageBitmap(blob);

                // Create a canvas to draw the image
                const canvas = document.createElement('canvas');
                canvas.width = bitmap.width;
                canvas.height = bitmap.height;
                canvas.getContext('2d').drawImage(bitmap, 0, 0);

                // Convert the canvas content to a PNG blob
                const pngBlob = await new Promise(r => canvas.toBlob(r, 'image/png'));

                // Copy the PNG blob to the clipboard
                await navigator.clipboard.write([new ClipboardItem({ 'image/png': pngBlob })]);

                // Notify the user of success
                alert('‚úÖ Image 3 copied to clipboard as PNG!');
            } catch (error) {
                // Handle errors (e.g., unsupported browser, HTTPS requirement)
                console.error(error);
                alert('‚ùå Failed to copy Image 3. Ensure you are using Chrome/Edge over HTTPS or localhost.');
            }
        });

        // Event listener for the fourth image copy button
        document.getElementById('copyBtn4').addEventListener('click', async () => {
            try {
                // Fetch the JPG image from the server
                const blob = await (await fetch('./images/photo.jpg')).blob();

                // Convert the image blob into a bitmap for rendering
                const bitmap = await createImageBitmap(blob);

                // Create a canvas to draw the image
                const canvas = document.createElement('canvas');
                canvas.width = bitmap.width;
                canvas.height = bitmap.height;
                canvas.getContext('2d').drawImage(bitmap, 0, 0);

                // Convert the canvas content to a PNG blob
                const pngBlob = await new Promise(r => canvas.toBlob(r, 'image/png'));

                // Copy the PNG blob to the clipboard
                await navigator.clipboard.write([new ClipboardItem({ 'image/png': pngBlob })]);

                // Notify the user of success
                alert('‚úÖ Image 4 copied to clipboard as PNG!');
            } catch (error) {
                // Handle errors (e.g., unsupported browser, HTTPS requirement)
                console.error(error);
                alert('‚ùå Failed to copy Image 4. Ensure you are using Chrome/Edge over HTTPS or localhost.');
            }
        });
    </script>
</body>

</html>